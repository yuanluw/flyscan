/***************************************************************************************************
  * 文 件 名: sysclock.c
  * 作    者：罗民
  *	日    期：2014/7/9
  * 版    本：V2.0
  * 开 发 板：TM4C123G6PZ--实验开发板
  * 修改时间：2016/8/21 
  * 编 译 器: keil.5
  *-------------------------------------------------------------------------------------------------
  * 简    介:
  * 参    考:
  *	笔记名称:
  * 注    意：
  *************************************************************************************************/  
/*--------包含头文件------------------------------------------------------------------------------*/
#include "sysclock.h"
#include "GpioInit.h"
/**************************************************************************************************/
/*--------变量的定义-------------------------------------------------------------------------------*/
uint8_t SysTimeOut_Flag=0;
/**************************************************************************************************/
/*--------结构体的定义-------------------------------------------------------------------------------*/

/**************************************************************************************************/
/*-------进口函数----------------------------------------------------------------------------------*/

/**************************************************************************************************/
/*--------函数模型----------------------------------------------------------------------------------*/
/***************************************************************************************************
	函数名: delay_ms
	输  入: ms
	输  出:	void
	功  能:	毫秒级延时函数
****************************************************************************************************/	
void delay_ms(uint16_t ms)
{
	SysCtlDelay(SysCtlClockGet()/1000*ms);
}
/***************************************************************************************************
	函数名: delay_us
	输  入: us
	输  出:	void
	功  能:	微秒级延时函数
****************************************************************************************************/	
void delay_us(uint16_t us)
{
	SysCtlDelay(SysCtlClockGet()/1000000*us);
}
/***************************************************************************************************
	函数名: SysClock_Init
	输  入: void
	输  出:	void
	功  能:	系统时钟初始化函数
****************************************************************************************************/	
void SysClock_Init(void)
{
   FPULazyStackingEnable();                     // 启动惰性中断堆栈
   SysCtlClockSet(SYSCTL_SYSDIV_1 | SYSCTL_USE_OSC | SYSCTL_OSC_MAIN |         // 系统源配置
                       SYSCTL_XTAL_16MHZ);
	
	 SysCtlPeripheralEnable(SYSCTL_PERIPH_TIMER4);
	//-------------- 周期时长控制的定时器 ------------------------------------
	 TimerConfigure(TIMER4_BASE, (
                       TIMER_CFG_A_PERIODIC));
    TimerLoadSet(TIMER4_BASE, TIMER_A, 64000);  //80000  5ms //4ms  64000

    IntEnable(INT_TIMER4A);
    TimerIntEnable(TIMER4_BASE, TIMER_TIMA_TIMEOUT);

    TimerEnable(TIMER4_BASE, TIMER_A);
}

uint8_t suspend_time=0;
uint16_t count=0; 
uint32_t boot_timer=0;
uint8_t course_reserval=0;
void TIMER4_STA_Handler(void)
{
   TimerIntClear(TIMER4_BASE, TIMER_TIMA_TIMEOUT);
	 SysTimeOut_Flag=1;
	boot_timer+=4;
}


uint32_t GetSysTimer(void)
{
	return 	boot_timer;
}



